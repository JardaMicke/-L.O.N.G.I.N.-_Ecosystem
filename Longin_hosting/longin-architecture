# ğŸ“Š LONGIN HOSTING - ARCHITECTURE & DIAGRAMS

**Verze:** 1.0  
**Datum:** BÅ™ezen 2025  
**Status:** COMPLETE VISUAL REFERENCE  

---

## ğŸ“‘ OBSAH

1. [System Architecture Diagram](#system-architecture-diagram)
2. [Microservices Communication](#microservices-communication)
3. [Data Flow Diagrams](#data-flow-diagrams)
4. [User Journey Flows](#user-journey-flows)
5. [Deployment Architecture](#deployment-architecture)
6. [Database Schema Diagram](#database-schema-diagram)
7. [Network Topology](#network-topology)
8. [Docker Swarm Cluster](#docker-swarm-cluster)

---

## ğŸ—ï¸ SYSTEM ARCHITECTURE DIAGRAM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        EXTERNAL USERS                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Browser    â”‚  â”‚ Desktop App â”‚  â”‚  Mobile (future)     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                 â”‚                     â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                     â”‚
          â”‚  HTTP/WS        â”‚  HTTP/WS            â”‚  HTTP/WS
          â”‚                 â”‚                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚  TRAEFIK REVERSE     â”‚                     â”‚
â”‚                    â”‚  PROXY & LB          â”‚                     â”‚
â”‚                    â”‚  â€¢ SSL/TLS           â”‚                     â”‚
â”‚                    â”‚  â€¢ Load balancing    â”‚                     â”‚
â”‚                    â”‚  â€¢ Service discovery â”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                               â”‚                                 â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚         â”‚                     â”‚                     â”‚           â”‚
â”‚         â–¼                     â–¼                     â–¼           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ React UI    â”‚      â”‚  Longin Core â”‚    â”‚  API Server  â”‚  â”‚
â”‚    â”‚ (Port 3000) â”‚      â”‚  (Port 3001) â”‚    â”‚  (Port 3001) â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                â”‚                    â”‚            â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚            â”‚
â”‚                    â”‚                        â”‚       â”‚            â”‚
â”‚                    â–¼                        â–¼       â–¼            â”‚
â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚             â”‚        LONGIN CORE SERVICES               â”‚      â”‚
â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚             â”‚ â€¢ Authentication & Authorization          â”‚      â”‚
â”‚             â”‚ â€¢ Request Routing & Validation            â”‚      â”‚
â”‚             â”‚ â€¢ Docker Container Management            â”‚      â”‚
â”‚             â”‚ â€¢ WebSocket Server (real-time)           â”‚      â”‚
â”‚             â”‚ â€¢ Metrics Aggregation                    â”‚      â”‚
â”‚             â”‚ â€¢ GitHub Webhook Handler                â”‚      â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                      â”‚            â”‚          â”‚                â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚      â”‚               â”‚            â”‚          â”‚        â”‚       â”‚
â”‚      â–¼               â–¼            â–¼          â–¼        â–¼       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Postgresâ”‚   â”‚  Redis   â”‚  â”‚ Logging  â”‚ â”‚Monit â”‚ â”‚ Swarm â”‚ â”‚
â”‚   â”‚ Databaseâ”‚   â”‚  Cache   â”‚  â”‚   ELK    â”‚ â”‚oring â”‚ â”‚Docker â”‚ â”‚
â”‚   â”‚5432    â”‚   â”‚  6379    â”‚  â”‚  9200    â”‚ â”‚ 9090 â”‚ â”‚ 2377  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  DOCKER SWARM ORCHESTRATION     â”‚
         â”‚  (Multi-machine cluster)        â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚  â€¢ Service scheduling          â”‚
         â”‚  â€¢ Container deployment        â”‚
         â”‚  â€¢ Overlay networking          â”‚
         â”‚  â€¢ Service discovery           â”‚
         â”‚  â€¢ Load distribution           â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
              â”‚          â”‚            â”‚
         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
         â”‚Managerâ”‚  â”‚Worker1â”‚  â”‚WorkerN  â”‚
         â”‚ Node  â”‚  â”‚ Node  â”‚  â”‚ Node    â”‚
         â”‚(PROD) â”‚  â”‚(PROD) â”‚  â”‚(PROD)   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚          â”‚            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  USER CONTAINERIZED APPS       â”‚
        â”‚  â€¢ Max 2 per user concurrently â”‚
        â”‚  â€¢ Port range: 4000-5000       â”‚
        â”‚  â€¢ Resource limited            â”‚
        â”‚  â€¢ Auto-scaled across nodes    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ MICROSERVICES COMMUNICATION DIAGRAM

```
SYNCHRONOUS COMMUNICATION (HTTP/REST):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Frontend (React)
    â”‚
    â”‚ HTTP/REST
    â”‚ (axios)
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Traefik Reverse Proxy  â”‚ â—„â”€â”€â”€ Routes requests
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                     â”‚
    â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  React UI    â”‚  â”‚  Longin Core API â”‚
â”‚  (3000)      â”‚  â”‚  (3001)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚              â”‚              â”‚
          â–¼              â–¼              â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ Postgresâ”‚   â”‚  Redis  â”‚   â”‚ Docker   â”‚
       â”‚ (5432)  â”‚   â”‚ (6379)  â”‚   â”‚ Socket   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ASYNCHRONOUS COMMUNICATION (WebSocket):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Frontend (React)
    â”‚
    â”‚ WebSocket/Socket.io
    â”‚ (authenticated)
    â–¼
Longin Core
  â”‚
  â”‚ (emit events)
  â”‚
  â”œâ”€â”€â–º "app:status_changed"
  â”œâ”€â”€â–º "container:metrics"
  â”œâ”€â”€â–º "deployment:progress"
  â”œâ”€â”€â–º "log:new_entry"
  â””â”€â”€â–º "system:alert"
  â”‚
  â””â”€â”€â–º (all connected clients receive updates)

EVENT QUEUE (Redis Pub/Sub):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Deployment Service  â”€â”€publishâ”€â”€â”
                                â”‚
                            â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
                            â”‚ Redis  â”‚
                            â”‚Pub/Sub â”‚
                            â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚               â”‚               â”‚
              subscribe     subscribe       subscribe
                â”‚               â”‚               â”‚
                â–¼               â–¼               â–¼
         WebSocket         Monitoring      Logging
         Broadcast         Service         Service


EXTERNAL INTEGRATIONS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

GitHub
  â”‚
  â”‚ Webhook (POST)
  â”‚ {push event}
  â”‚
  â–¼
Longin Core
  â”‚
  â”œâ”€â–º Verify signature
  â”œâ”€â–º Extract repo info
  â”œâ”€â–º Queue build job
  â”‚
  â–¼
Redis Job Queue
  â”‚
  â”œâ”€â–º Docker build
  â”œâ”€â–º Image push
  â”œâ”€â–º Container deploy
  â”‚
  â””â”€â–º Emit "deployment:success"
```

---

## ğŸ“ˆ DATA FLOW DIAGRAMS

### User Registration Flow

```
User Input Form
  â”‚
  â”‚ Email, Username, Password
  â”‚
  â–¼
POST /api/auth/register
  â”‚
  â”œâ”€â–º Validate inputs (class-validator)
  â”‚   â”œâ”€ Email format
  â”‚   â”œâ”€ Username length & chars
  â”‚   â””â”€ Password strength
  â”‚
  â”œâ”€â–º Check if user exists (PostgreSQL)
  â”‚   â”œâ”€ Query: SELECT * FROM users WHERE email = ?
  â”‚   â”‚
  â”‚   â”œâ”€ User EXISTS
  â”‚   â”‚   â””â”€â–º 409 Conflict error
  â”‚   â”‚
  â”‚   â””â”€ User NOT EXISTS
  â”‚       â””â”€â–º Continue
  â”‚
  â”œâ”€â–º Hash password (bcryptjs, 10 rounds)
  â”‚   â””â”€ plaintext â†’ hashed password
  â”‚
  â”œâ”€â–º Create user record (INSERT)
  â”‚   â”œâ”€ Store in PostgreSQL
  â”‚   â””â”€ Generate UUID
  â”‚
  â”œâ”€â–º Generate JWT tokens
  â”‚   â”œâ”€ Access Token (1h)
  â”‚   â”œâ”€ Refresh Token (7d)
  â”‚   â””â”€ Store refresh in Redis
  â”‚
  â””â”€â–º Return 201 + user + tokens
      â”‚
      â””â”€â–º Frontend stores tokens
          â”œâ”€ httpOnly cookie (access)
          â””â”€ Session storage (refresh)
```

### Application Start Flow

```
User clicks START button
  â”‚
  â”‚ Frontend emits event
  â”‚
  â–¼
POST /api/apps/:appId/start
  â”‚
  â”œâ”€â–º Authenticate (JWT validation)
  â”‚
  â”œâ”€â–º Authorize (user owns app)
  â”‚
  â”œâ”€â–º Check max instances
  â”‚   â”œâ”€ SELECT COUNT(*) FROM containers 
  â”‚   â”‚  WHERE app_id = ? AND status = 'running'
  â”‚   â”‚
  â”‚   â”œâ”€ Count < max_instances?
  â”‚   â”‚   â””â”€â–º YES: Continue
  â”‚   â”‚
  â”‚   â””â”€ Count >= max_instances?
  â”‚       â””â”€â–º Return 409 error
  â”‚
  â”œâ”€â–º Check resource availability
  â”‚   â”œâ”€ Available CPU?
  â”‚   â”œâ”€ Available Memory?
  â”‚   â””â”€ Available Disk?
  â”‚
  â”œâ”€â–º Docker pull image (if needed)
  â”‚   â””â”€ docker pull {image_url}
  â”‚
  â”œâ”€â–º Allocate port (4000-5000)
  â”‚   â””â”€ Find first available
  â”‚
  â”œâ”€â–º Create container
  â”‚   â”œâ”€ docker create
  â”‚   â”œâ”€ Set resource limits
  â”‚   â””â”€ Configure environment
  â”‚
  â”œâ”€â–º Start container
  â”‚   â””â”€ docker start
  â”‚
  â”œâ”€â–º Wait for health check
  â”‚   â”œâ”€ Poll container status
  â”‚   â”œâ”€ Timeout: 30 seconds
  â”‚   â””â”€ Status: running/unhealthy/timeout
  â”‚
  â”œâ”€â–º Register in database
  â”‚   â”œâ”€ INSERT INTO containers
  â”‚   â””â”€ Store port, IP, node info
  â”‚
  â”œâ”€â–º Update app status
  â”‚   â””â”€ UPDATE applications SET status = 'running'
  â”‚
  â”œâ”€â–º Broadcast via WebSocket
  â”‚   â””â”€ emit('app:status', {id, status, metrics})
  â”‚
  â””â”€â–º Return 200 + container info
      â”‚
      â””â”€â–º Frontend updates UI
          â”œâ”€ Show status badge
          â”œâ”€ Display URL
          â””â”€ Show metrics
```

### Metrics Collection Flow

```
Every 5 seconds (interval)
  â”‚
  â–¼
Prometheus scraper
  â”‚
  â”œâ”€â–º Query Docker daemon
  â”‚   â””â”€ GET /v1.40/containers/stats
  â”‚
  â”œâ”€â–º Parse response
  â”‚   â”œâ”€ CPU usage
  â”‚   â”œâ”€ Memory usage
  â”‚   â”œâ”€ Network I/O
  â”‚   â””â”€ Block I/O
  â”‚
  â”œâ”€â–º Store in Prometheus
  â”‚   â””â”€ Time-series DB
  â”‚
  â”œâ”€â–º Calculate metrics
  â”‚   â”œâ”€ CPU percentage
  â”‚   â”œâ”€ Memory percentage
  â”‚   â””â”€ Network rate
  â”‚
  â”œâ”€â–º Store in PostgreSQL (5 min interval)
  â”‚   â””â”€ INSERT INTO metrics
  â”‚
  â”œâ”€â–º Push to Redis
  â”‚   â””â”€ set "app:{appId}:current_metrics"
  â”‚
  â”œâ”€â–º Publish via WebSocket
  â”‚   â””â”€ emit('container:metrics', {cpu, mem, net})
  â”‚
  â””â”€â–º Grafana scrapes & visualizes
      â”œâ”€ Prometheus endpoint
      â””â”€ Real-time dashboards
```

### GitHub Webhook Flow

```
Developer: git push origin main
  â”‚
  â–¼
GitHub Actions
  â”‚
  â”œâ”€â–º Build & test
  â”‚
  â””â”€â–º Send webhook
      â”‚
      POST https://longin.com/api/webhooks/github
      Headers: X-Hub-Signature-256
      Body: {
        event: "push",
        ref: "refs/heads/main",
        repository: {...},
        commits: [...]
      }
      â”‚
      â–¼
Longin Core receives webhook
  â”‚
  â”œâ”€â–º Verify signature (HMAC-SHA256)
  â”‚   â”œâ”€ Compare X-Hub-Signature-256
  â”‚   â””â”€ Must match GITHUB_WEBHOOK_SECRET
  â”‚
  â”œâ”€â–º Extract data
  â”‚   â”œâ”€ Repository URL
  â”‚   â”œâ”€ Branch
  â”‚   â”œâ”€ Commit hash
  â”‚   â””â”€ Commit message
  â”‚
  â”œâ”€â–º Find app by repo
  â”‚   â””â”€ SELECT * FROM applications WHERE github_repo_url = ?
  â”‚
  â”œâ”€â–º Create deployment record
  â”‚   â”œâ”€ INSERT INTO deployments
  â”‚   â””â”€ Status: 'pending'
  â”‚
  â”œâ”€â–º Queue deployment job
  â”‚   â”œâ”€ Add to Redis job queue
  â”‚   â””â”€ Worker picks it up
  â”‚
  â”œâ”€â–º Broadcast progress
  â”‚   â””â”€ emit('deployment:progress', {status: 'queued'})
  â”‚
  â””â”€â–º Deployment Worker:
      â”‚
      â”œâ”€â–º Clone GitHub repo
      â”‚   â””â”€ git clone {repo_url} --branch {branch}
      â”‚
      â”œâ”€â–º Find Dockerfile
      â”‚   â””â”€ Check dockerfile_path from app config
      â”‚
      â”œâ”€â–º Build Docker image
      â”‚   â”œâ”€ docker build -t {image_tag}
      â”‚   â””â”€ emit('deployment:progress', {status: 'building'})
      â”‚
      â”œâ”€â–º Push to registry (optional)
      â”‚   â””â”€ docker push {image_tag}
      â”‚
      â”œâ”€â–º Stop old container (if running)
      â”‚   â””â”€ docker stop {old_container_id}
      â”‚
      â”œâ”€â–º Start new container
      â”‚   â”œâ”€ docker run {new_image}
      â”‚   â””â”€ emit('deployment:progress', {status: 'starting'})
      â”‚
      â”œâ”€â–º Health check
      â”‚   â”œâ”€ Wait for container ready
      â”‚   â””â”€ Timeout: 60 seconds
      â”‚
      â”œâ”€â–º Update deployment record
      â”‚   â”œâ”€ Status: 'success' or 'failed'
      â”‚   â””â”€ UPDATE deployments
      â”‚
      â””â”€â–º Broadcast completion
          â””â”€ emit('deployment:success' or 'failed')
```

---

## ğŸ¯ USER JOURNEY FLOWS

### Journey: New User Registration â†’ App Launch

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: ONBOARDING                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User visits https://longin.local
       â”‚
       â–¼
   See Login page
       â”‚
       â””â”€â–º Not registered?
           â”‚
           â–¼
       Click "Sign Up"
           â”‚
           â–¼
       Fill registration form
       â€¢ Username: gamedev
       â€¢ Email: user@example.com
       â€¢ Password: SecurePass123!
           â”‚
           â–¼
       Submit registration
           â”‚
           â”œâ”€â–º Validation error?
           â”‚   â””â”€â–º Show error message
           â”‚       (retry)
           â”‚
           â””â”€â–º Success?
               â”‚
               â–¼
           User account created
           JWT tokens issued
           Redirect to dashboard


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: EXPLORING APPS                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Dashboard loads
       â”‚
       â”œâ”€â–º My Applications (empty)
       â”‚
       â””â”€â–º Available Applications
           â”œâ”€ Web Server
           â”œâ”€ Chat App
           â”œâ”€ Database Tool
           â””â”€ Game Server
           â”‚
           â–¼
       Browse applications
           â”‚
           â””â”€â–º Click "Game Server"
               â”‚
               â–¼
           See app details
           â€¢ Description
           â€¢ Owner: admin
           â€¢ Rating: â­â­â­â­â­
           â€¢ Current instances: 1/2
           â”‚
           â–¼
           Click LAUNCH


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: LAUNCHING APP                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Send POST /api/apps/{appId}/start
       â”‚
       â”œâ”€â–º Permission check
       â”‚   â””â”€â–º PASS (user role)
       â”‚
       â”œâ”€â–º Max instances check
       â”‚   â””â”€â–º OK (1/2 running)
       â”‚
       â”œâ”€â–º Docker container creation
       â”‚   â””â”€â–º Assign port 4001
       â”‚
       â”œâ”€â–º Container starts
       â”‚   â””â”€â–º Health check... âœ“
       â”‚
       â”œâ”€â–º Database update
       â”‚   â””â”€â–º containers table
       â”‚
       â”œâ”€â–º WebSocket broadcast
       â”‚   â””â”€â–º app:status event
       â”‚
       â””â”€â–º Return 200
           â”‚
           â–¼
       Frontend displays:
       â€¢ Status: â— Running
       â€¢ URL: http://localhost:4001
       â€¢ Uptime: Just started
       â€¢ CPU: 12%
       â€¢ Memory: 128MB
           â”‚
           â–¼
       User clicks OPEN
           â”‚
           â–¼
       Opens http://localhost:4001 in new tab
           â”‚
           â–¼
       App is running! âœ“


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 4: MONITORING                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Real-time metrics (via WebSocket)
       â”‚
       â”œâ”€â–º CPU Chart
       â”‚   â””â”€ 5%, 8%, 12%, 15%, 10% (live)
       â”‚
       â”œâ”€â–º Memory Chart
       â”‚   â””â”€ 128MB, 140MB, 155MB (live)
       â”‚
       â”œâ”€â–º Network Chart
       â”‚   â””â”€ In: 2.5MB/s, Out: 1.2MB/s
       â”‚
       â””â”€â–º Logs Panel
           â”œâ”€ [14:22:30] Server started on port 8080
           â”œâ”€ [14:22:35] User connected
           â””â”€ [14:23:00] Processing request...


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 5: STOPPING APP                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User clicks STOP
       â”‚
       â–¼
   POST /api/apps/{appId}/stop
       â”‚
       â”œâ”€â–º Permission check
       â”‚
       â”œâ”€â–º Docker stop container
       â”‚   â””â”€ Graceful shutdown (timeout: 10s)
       â”‚
       â”œâ”€â–º Database update
       â”‚
       â””â”€â–º WebSocket broadcast
           â”‚
           â–¼
       Status: âŠ˜ Stopped
       Uptime: 2h 15m 30s (saved)
```

---

## ğŸš€ DEPLOYMENT ARCHITECTURE

```
DEVELOPMENT ENVIRONMENT (Docker Desktop):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Developer Machine (Windows)     â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Docker Desktop             â”‚â”‚
â”‚  â”‚  â€¢ Compose v2               â”‚â”‚
â”‚  â”‚  â€¢ Swarm disabled           â”‚â”‚
â”‚  â”‚  â€¢ Linux VM                 â”‚â”‚
â”‚  â”‚  â€¢ Storage: WSL2 volumes    â”‚â”‚
â”‚  â”‚                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚â”‚
â”‚  â”‚  â”‚ docker-compose.yml â”‚    â”‚â”‚
â”‚  â”‚  â”‚ (development)      â”‚    â”‚â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚â”‚
â”‚  â”‚  â”‚ Services:          â”‚    â”‚â”‚
â”‚  â”‚  â”‚ â€¢ longin-core      â”‚    â”‚â”‚
â”‚  â”‚  â”‚ â€¢ longin-ui        â”‚    â”‚â”‚
â”‚  â”‚  â”‚ â€¢ postgres         â”‚    â”‚â”‚
â”‚  â”‚  â”‚ â€¢ redis            â”‚    â”‚â”‚
â”‚  â”‚  â”‚ â€¢ prometheus       â”‚    â”‚â”‚
â”‚  â”‚  â”‚ â€¢ grafana          â”‚    â”‚â”‚
â”‚  â”‚  â”‚ â€¢ elasticsearch    â”‚    â”‚â”‚
â”‚  â”‚  â”‚ â€¢ kibana           â”‚    â”‚â”‚
â”‚  â”‚  â”‚ â€¢ logstash         â”‚    â”‚â”‚
â”‚  â”‚  â”‚ â€¢ traefik          â”‚    â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚â”‚
â”‚  â”‚                             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                 â”‚
â”‚  Ports: localhost:3000-9200    â”‚
â”‚  .env: local (never committed) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STAGING/PRODUCTION ENVIRONMENT (Docker Swarm):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 PRODUCTION NETWORK                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ Manager Node    â”‚  â”‚ Worker Node 1   â”‚              â”‚
â”‚  â”‚ (Primary)       â”‚  â”‚ (Replicas)      â”‚              â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚              â”‚
â”‚  â”‚ Swarm Manager   â”‚  â”‚ Container Host  â”‚              â”‚
â”‚  â”‚ Services:       â”‚  â”‚                 â”‚              â”‚
â”‚  â”‚ â€¢ longin-core   â”‚  â”‚ Running Apps:   â”‚              â”‚
â”‚  â”‚ â€¢ longin-ui     â”‚  â”‚ â€¢ App1          â”‚              â”‚
â”‚  â”‚ â€¢ postgres      â”‚  â”‚ â€¢ App2          â”‚              â”‚
â”‚  â”‚ â€¢ redis         â”‚  â”‚ â€¢ AppN          â”‚              â”‚
â”‚  â”‚ â€¢ prometheus    â”‚  â”‚                 â”‚              â”‚
â”‚  â”‚ â€¢ grafana       â”‚  â”‚                 â”‚              â”‚
â”‚  â”‚ â€¢ elasticsearch â”‚  â”‚                 â”‚              â”‚
â”‚  â”‚ â€¢ logstash      â”‚  â”‚                 â”‚              â”‚
â”‚  â”‚ â€¢ kibana        â”‚  â”‚                 â”‚              â”‚
â”‚  â”‚ â€¢ traefik       â”‚  â”‚                 â”‚              â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚           â”‚                    â”‚                       â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                    â”‚                                   â”‚
â”‚           Overlay Network (VXLAN)                     â”‚
â”‚           â€¢ Service discovery                         â”‚
â”‚           â€¢ Load balancing                            â”‚
â”‚           â€¢ Cross-node communication                  â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ DATABASE SCHEMA DIAGRAM (ER)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      USERS          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id (UUID)       â”‚
â”‚ UQ  username        â”‚
â”‚ UQ  email           â”‚
â”‚     password_hash   â”‚
â”‚     role            â”‚
â”‚     is_active       â”‚
â”‚     created_at      â”‚
â”‚     updated_at      â”‚
â”‚     last_login      â”‚
â”‚     theme           â”‚
â”‚ FK  (none)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ (1:N) owns
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    APPLICATIONS             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id (UUID)               â”‚
â”‚     name                    â”‚
â”‚     description             â”‚
â”‚     version                 â”‚
â”‚     docker_image            â”‚
â”‚     dockerfile_path         â”‚
â”‚     docker_compose_file     â”‚
â”‚     github_repo_url         â”‚
â”‚     github_branch           â”‚
â”‚     webhook_token           â”‚
â”‚     port_internal           â”‚
â”‚     port_external           â”‚
â”‚     custom_url (UQ)         â”‚
â”‚     env_vars (JSONB)        â”‚
â”‚     status                  â”‚
â”‚     is_public               â”‚
â”‚     max_instances           â”‚
â”‚     current_instances       â”‚
â”‚     owner_id (FK)           â”‚
â”‚     created_at              â”‚
â”‚     updated_at              â”‚
â”‚     auto_update_enabled     â”‚
â”‚     auto_update_interval    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ (1:N) contains
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    CONTAINERS               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id (UUID)               â”‚
â”‚ UQ  container_id            â”‚
â”‚     app_id (FK)             â”‚
â”‚     cpu_limit               â”‚
â”‚     memory_limit            â”‚
â”‚     port_assigned           â”‚
â”‚     ip_address              â”‚
â”‚     status                  â”‚
â”‚     started_at              â”‚
â”‚     exited_at               â”‚
â”‚     node_id                 â”‚
â”‚     node_name               â”‚
â”‚     created_at              â”‚
â”‚     updated_at              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ (1:N) has
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     METRICS                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id (BIGSERIAL)          â”‚
â”‚     container_id (FK)       â”‚
â”‚     cpu_percent             â”‚
â”‚     memory_bytes            â”‚
â”‚     memory_percent          â”‚
â”‚     net_in_bytes            â”‚
â”‚     net_out_bytes           â”‚
â”‚     block_read_bytes        â”‚
â”‚     block_write_bytes       â”‚
â”‚     pids_current            â”‚
â”‚     recorded_at             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    DEPLOYMENTS               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id (UUID)                â”‚
â”‚     app_id (FK)              â”‚
â”‚     deployment_type          â”‚
â”‚     status                   â”‚
â”‚     git_commit_hash          â”‚
â”‚     git_commit_message       â”‚
â”‚     git_branch               â”‚
â”‚     deployed_by (FK, USERS)  â”‚
â”‚     docker_image_hash        â”‚
â”‚     docker_image_size        â”‚
â”‚     started_at               â”‚
â”‚     completed_at             â”‚
â”‚     duration_seconds         â”‚
â”‚     build_log                â”‚
â”‚     deployment_error         â”‚
â”‚     created_at               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GITHUB_WEBHOOKS            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id (UUID)                â”‚
â”‚     app_id (FK)              â”‚
â”‚     event_type               â”‚
â”‚     webhook_payload (JSONB)  â”‚
â”‚     status                   â”‚
â”‚     processing_log           â”‚
â”‚     created_at               â”‚
â”‚     processed_at             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    API_LOGS                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id (BIGSERIAL)           â”‚
â”‚     user_id (FK)             â”‚
â”‚     method                   â”‚
â”‚     endpoint                 â”‚
â”‚     status_code              â”‚
â”‚     response_time_ms         â”‚
â”‚     request_size_bytes       â”‚
â”‚     response_size_bytes      â”‚
â”‚     ip_address               â”‚
â”‚     user_agent               â”‚
â”‚     logged_at                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ NETWORK TOPOLOGY

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   EXTERNAL INTERNET                      â”‚
â”‚          (GitHub, Docker Hub, Users)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   GATEWAY / FIREWALL        â”‚
        â”‚  â€¢ Deny inbound by default  â”‚
        â”‚  â€¢ Allow: 80, 443           â”‚
        â”‚  â€¢ Allow: 22 (SSH, limited) â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  TRAEFIK (Reverse Proxy)    â”‚
        â”‚  Port: 80, 443              â”‚
        â”‚  â€¢ SSL/TLS termination      â”‚
        â”‚  â€¢ Service routing          â”‚
        â”‚  â€¢ Load balancing           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      PUBLIC NETWORK         â”‚
        â”‚  (Internal Docker network)  â”‚
        â”‚  IP Range: 172.17.0.0/16    â”‚
        â”‚                             â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚                             â”‚
        â”œâ”€ React UI (3000)            â”‚
        â”œâ”€ API Gateway (3001)         â”‚
        â”œâ”€ WebSocket (3002)           â”‚
        â”œâ”€ Prometheus (9090)          â”‚
        â”œâ”€ Grafana (3003)             â”‚
        â”œâ”€ Kibana (5601)              â”‚
        â””â”€ Traefik Dashboard (8080)   â”‚
        â”‚                             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   PRIVATE NETWORK           â”‚
        â”‚  (Internal Docker network)  â”‚
        â”‚  IP Range: 172.18.0.0/16    â”‚
        â”‚  * NO external access       â”‚
        â”‚                             â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚                             â”‚
        â”œâ”€ PostgreSQL (5432)          â”‚
        â”œâ”€ Redis (6379)               â”‚
        â”œâ”€ Elasticsearch (9200)       â”‚
        â”œâ”€ Logstash (5044)            â”‚
        â”‚                             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    SWARM NETWORK            â”‚
        â”‚  (Overlay - VXLAN)          â”‚
        â”‚  For container-to-container â”‚
        â”‚  communication              â”‚
        â”‚                             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   USER APP CONTAINERS       â”‚
        â”‚   (Dynamic ports 4000-5000) â”‚
        â”‚   * Each app in own namespaceâ”‚
        â”‚                             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ³ DOCKER SWARM CLUSTER DIAGRAM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 DOCKER SWARM CLUSTER                  â”‚
â”‚                   (Multi-machine)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚              MANAGER NODE                        â”‚ â”‚
â”‚ â”‚         (Raft Consensus Leader)                  â”‚ â”‚
â”‚ â”‚                                                  â”‚ â”‚
â”‚ â”‚  Hostname: longin-manager                       â”‚ â”‚
â”‚ â”‚  Role: Manager                                  â”‚ â”‚
â”‚ â”‚  Status: Ready & Active                         â”‚ â”‚
â”‚ â”‚                                                  â”‚ â”‚
â”‚ â”‚  Manages:                                       â”‚ â”‚
â”‚ â”‚  âœ“ Cluster state                                â”‚ â”‚
â”‚ â”‚  âœ“ Service scheduling                           â”‚ â”‚
â”‚ â”‚  âœ“ Certificate rotation                         â”‚ â”‚
â”‚ â”‚  âœ“ Load balancing                               â”‚ â”‚
â”‚ â”‚                                                  â”‚ â”‚
â”‚ â”‚  Services Running:                              â”‚ â”‚
â”‚ â”‚  â€¢ longin-core (3 replicas)                     â”‚ â”‚
â”‚ â”‚  â€¢ longin-ui (2 replicas)                       â”‚ â”‚
â”‚ â”‚  â€¢ postgres (1 replica)                         â”‚ â”‚
â”‚ â”‚  â€¢ redis (1 replica)                            â”‚ â”‚
â”‚ â”‚  â€¢ prometheus (1 replica)                       â”‚ â”‚
â”‚ â”‚  â€¢ traefik (global - 1 per node)                â”‚ â”‚
â”‚ â”‚  â€¢ elasticsearch (1 replica)                    â”‚ â”‚
â”‚ â”‚                                                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚  WORKER NODE 1       â”‚  â”‚  WORKER NODE 2       â”‚   â”‚
â”‚ â”‚                      â”‚  â”‚                      â”‚   â”‚
â”‚ â”‚  Hostname: worker-1  â”‚  â”‚  Hostname: worker-2  â”‚   â”‚
â”‚ â”‚  Role: Worker        â”‚  â”‚  Role: Worker        â”‚   â”‚
â”‚ â”‚  Status: Ready       â”‚  â”‚  Status: Ready       â”‚   â”‚
â”‚ â”‚                      â”‚  â”‚                      â”‚   â”‚
â”‚ â”‚  Containers:         â”‚  â”‚  Containers:         â”‚   â”‚
â”‚ â”‚  â€¢ longin-core-r2    â”‚  â”‚  â€¢ longin-core-r3    â”‚   â”‚
â”‚ â”‚  â€¢ longin-ui-r2      â”‚  â”‚  â€¢ longin-ui-r1      â”‚   â”‚
â”‚ â”‚  â€¢ User App 1        â”‚  â”‚  â€¢ User App 2        â”‚   â”‚
â”‚ â”‚  â€¢ User App 3        â”‚  â”‚  â€¢ User App N        â”‚   â”‚
â”‚ â”‚  â€¢ traefik (global)  â”‚  â”‚  â€¢ traefik (global)  â”‚   â”‚
â”‚ â”‚                      â”‚  â”‚                      â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â–²                           â–²                â”‚
â”‚          â”‚                           â”‚                â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                        â”‚                              â”‚
â”‚    Cluster Communication:                            â”‚
â”‚    â€¢ Manager Port: 2377 (TCP)                        â”‚
â”‚    â€¢ Node Comm: 7946 (TCP/UDP)                       â”‚
â”‚    â€¢ VXLAN: 4789 (UDP)                               â”‚
â”‚                                                        â”‚
â”‚    Overlay Network: longin-swarm                     â”‚
â”‚    â€¢ Service discovery (DNS)                         â”‚
â”‚    â€¢ Internal load balancing                         â”‚
â”‚    â€¢ Automatic failover                              â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š MONITORING STACK ARCHITECTURE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 OBSERVABILITY STACK                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

COLLECTION LAYER:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚          â”‚      â”‚       â”‚         â”‚
    â–¼          â–¼      â–¼       â–¼         â–¼
   App        Docker  Host   Custom    Logs
  Metrics    Metrics  System  Metrics   Stdout
    â”‚          â”‚      â”‚       â”‚         â”‚
    â”‚          â”‚      â”‚       â”‚         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
STORAGE LAYER:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚
    â”œâ”€â”€â–º Prometheus (Time-series DB)
    â”‚    â€¢ Container metrics
    â”‚    â€¢ API metrics
    â”‚    â€¢ System metrics
    â”‚    â€¢ 30-day retention
    â”‚
    â”œâ”€â”€â–º Elasticsearch (Log index)
    â”‚    â€¢ Application logs
    â”‚    â€¢ System logs
    â”‚    â€¢ API logs
    â”‚    â€¢ 30-day retention
    â”‚
    â””â”€â”€â–º PostgreSQL (Historical)
         â€¢ Aggregated metrics
         â€¢ Deployment history
         â€¢ User actions
         â€¢ Long-term trend analysis

VISUALIZATION & ANALYSIS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚
    â”œâ”€â”€â–º Grafana
    â”‚    â€¢ Real-time dashboards
    â”‚    â€¢ System overview
    â”‚    â€¢ Per-app metrics
    â”‚    â€¢ Alert visualization
    â”‚
    â””â”€â”€â–º Kibana
         â€¢ Log search & analysis
         â€¢ Full-text search
         â€¢ Log patterns
         â€¢ Debugging dashboard

ALERTING LAYER:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚
    â”œâ”€â”€â–º Prometheus AlertManager
    â”‚    â€¢ Rules evaluation
    â”‚    â€¢ Alert grouping
    â”‚    â€¢ Deduplication
    â”‚
    â”œâ”€â”€â–º Notification Channels
    â”‚    â”œâ”€ Slack (#alerts)
    â”‚    â”œâ”€ Email (ops@company.com)
    â”‚    â”œâ”€ PagerDuty (critical)
    â”‚    â””â”€ SMS (on-call)
    â”‚
    â””â”€â”€â–º Longin Core
         â€¢ Custom alerts
         â€¢ User notifications
```

---

**Document Version:** 1.0  
**Created:** BÅ™ezen 2025  
**Status:** COMPLETE - Ready for implementation